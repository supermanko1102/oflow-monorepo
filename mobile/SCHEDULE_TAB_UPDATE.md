# 排程 Tab 更新 - 接單模式整合

## ✅ 完成變更

### 1. 新增排程 Tab 頁面
**檔案：`app/(main)/(tabs)/schedule.tsx`**

將「接單模式選擇」整合進排程 Tab，成為統一的接單設定入口：

#### 功能包含：
- ✅ **接單模式選擇**
  - 全自動模式（AI 自動接單）
  - 半自動模式（手動確認後接單）
  
- ✅ **視覺化卡片設計**
  - 清楚顯示每個模式的特點
  - 全自動需要排班設定的提示
  - 半自動排班為選填的說明

- ✅ **排班小幫手入口**
  - 顯示當前排班狀態摘要
  - 點擊跳轉到詳細排班設定頁面

- ✅ **智慧提示**
  - 如果選擇全自動但未設定排班，顯示警告
  - 提供使用建議卡片

### 2. 簡化設置頁面
**檔案：`app/(main)/(tabs)/settings.tsx`**

移除重複的接單模式設定：
- ❌ 移除「接單模式」section
- ❌ 移除「排班設定」入口
- ✅ 保留通知設定、帳號資訊等其他設定

---

## 📱 新的 Tab 架構

```
Tab 1: 今日 📅
- 今日待辦清單
- 訂單完成進度
- 未來訂單預覽

Tab 2: 訂單 📋
- 全部訂單管理
- 搜尋和篩選
- 訂單詳情

Tab 3: 排程 ⚙️
- 接單模式選擇（全自動/半自動）
- 排班小幫手設定
- 可接單時間管理

Tab 4: 設置 🔧
- 通知設定
- 帳號資訊
- 關於應用
```

---

## 🎯 設計邏輯

### 為什麼把接單模式放在「排程」Tab？

1. **邏輯連貫**
   - 接單模式 + 排班設定 = 完整的「如何接單」配置
   - 全自動模式依賴排班設定，放在一起更直觀

2. **減少認知負擔**
   - 所有「接單相關」的設定集中在一個地方
   - 不用在多個頁面之間跳轉

3. **清楚的層級關係**
   ```
   排程 Tab
   ├─ 接單模式（決定由誰接單）
   │  ├─ 全自動：AI 自動接單
   │  └─ 半自動：手動確認
   └─ 排班設定（決定何時接單）
      ├─ 營業時間
      ├─ 可接單時段
      └─ 特殊日期
   ```

---

## 💡 使用者體驗

### 第一次使用流程
1. 進入「排程」Tab
2. 看到兩種接單模式的卡片
3. 選擇「半自動模式」開始使用（建議）
4. 熟悉後，可以設定排班並切換到「全自動模式」

### 切換到全自動的流程
1. 點擊「可接單時間」進入排班設定
2. 設定每週營業時間
3. 回到排程頁面
4. 開啟「全自動模式」開關
5. 系統提示切換成功

### 如果未設定排班就開啟全自動
- 顯示 Toast 警告：「請先設定排班時間」
- 開關不會切換
- 引導用戶先設定排班

---

## 🎨 UI 設計亮點

### 1. 卡片式選擇
- 使用大卡片而非簡單的 List Item
- 清楚標示每個模式的特點和限制
- 選中狀態有明顯的視覺回饋（綠色邊框 + 背景）

### 2. 圖標語言
- 🤖 機器人 = 全自動（AI 處理）
- ✅ 勾選 = 半自動（人工確認）
- 📅 行事曆 = 排班設定

### 3. 資訊階層
```
第一層：接單模式選擇（核心決策）
第二層：排班設定入口（配置）
第三層：使用建議（輔助理解）
```

### 4. 智慧提示
- 全自動卡片顯示「需要先設定排班時間」
- 半自動卡片顯示「排班設定為選填」
- 底部建議卡片提供最佳實踐

---

## 🔧 技術實作

### 狀態管理
```typescript
// 接單模式狀態（來自 useSettingsStore）
const autoMode = useSettingsStore((state) => state.autoMode);
const setAutoMode = useSettingsStore((state) => state.setAutoMode);

// 排班狀態（來自 useScheduleStore）
const schedule = useScheduleStore((state) => state.schedule);
```

### 驗證邏輯
```typescript
const handleToggleAutoMode = (value: boolean) => {
  if (value && !schedule) {
    // 如果要開啟全自動但還沒設定排班，阻止並提示
    toast.warning('請先設定排班時間');
    return;
  }
  setAutoMode(value);
};
```

### 排班摘要顯示
```typescript
const getScheduleSummary = () => {
  if (!schedule) return '尚未設定';
  
  const openDays = Object.values(schedule.weeklySchedule).filter(
    day => day.isOpen
  ).length;
  
  const businessTypeText = schedule.businessType === 'pickup' ? '取貨制' : '預約制';
  return `${businessTypeText} · 每週營業 ${openDays} 天`;
};
```

---

## 📊 與之前的比較

### 之前的架構
```
設置頁面
├─ 帳號資訊
├─ 接單模式 ⚙️
├─ 排班設定 → 跳轉到 schedule 頁面
├─ 通知設定
└─ 關於
```
**問題：** 接單模式和排班設定分散，邏輯不清楚

### 現在的架構
```
排程 Tab
├─ 接單模式選擇 ⚙️
└─ 排班小幫手 → 跳轉到詳細設定

設置頁面
├─ 帳號資訊
├─ 通知設定
└─ 關於
```
**優點：** 接單相關設定集中，邏輯清晰

---

## 🚀 未來可以加強

### 1. 接單模式預覽
- 顯示「如果現在有客人詢問，系統會如何處理」
- 模擬對話範例

### 2. 智慧建議
- 根據商家使用習慣，建議最適合的模式
- 「您過去 80% 的訂單都在營業時間內，建議使用全自動模式」

### 3. 模式切換記錄
- 顯示切換歷史
- 分析不同模式下的接單效率

### 4. 快速設定精靈
- 針對新用戶的引導流程
- 3 步完成接單設定

---

## ✅ 檢查清單

- [x] 建立新的排程 Tab 頁面
- [x] 整合接單模式選擇
- [x] 加入排班設定入口
- [x] 實作全自動模式驗證
- [x] 設計視覺化卡片
- [x] 從設置頁面移除重複功能
- [x] 清理未使用的導入
- [x] 通過 Linter 檢查
- [x] 更新文件

---

## 📝 總結

這次更新讓「排程」Tab 成為真正的**接單配置中心**，而不只是排班工具。

**核心改變：**
- ✅ 接單模式（全自動/半自動）移到排程 Tab
- ✅ 視覺化卡片設計，清楚展示差異
- ✅ 智慧驗證，防止錯誤配置
- ✅ 簡化設置頁面，專注於系統設定

**用戶體驗提升：**
- 📍 所有接單相關設定在一個地方
- 🎯 清楚的資訊階層
- 💡 貼心的使用建議
- ⚠️ 即時的錯誤提示

這樣的設計更符合商家的心智模型：「我想控制如何接單」→「去排程 Tab」

